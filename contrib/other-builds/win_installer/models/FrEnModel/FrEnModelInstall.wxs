<?xml version='1.0' encoding='UTF-8'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Name='Moses French-English Sample Phrase-Based Model' Id='774B72A5-B35E-4E1E-AB2C-998F76AE0A5B' UpgradeCode='107C13CE-6C5D-4776-9E5F-248352A145AD'
    Language='1033' Codepage='1252' Version='1.0.0.0' Manufacturer='Capita TI'>

    <Package Id='*' Keywords='Installer'
      Description="Sample French to English Phrase-based model for Moses installation on Windows."
      Comments='Only for internal usage.' Manufacturer='Capita TI'
      InstallerVersion='100' Languages='1033' Compressed='yes' SummaryCodepage='1252' />

    <Media Id='1' Cabinet='FrEnModel.cab' EmbedCab='yes' DiskPrompt="CD-ROM #1" CompressionLevel="high" />
    <Property Id='DiskPrompt' Value="FrEnModel Installation [1]" />
	
	<Property Id="MOSESDECODERPATH" >
		<RegistrySearch Id="MOSESDECODERPATHRegistry" Type="raw" Root="HKCU" Key="SOFTWARE\Moses Core Team\MosesDecoder" Name="Path" />
	</Property>

    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id='ProgramFilesFolder' Name='PFiles'>
        <Directory Id='Moses' Name='Moses'>
			<Directory Id='Models' Name='Models'>
				<Directory Id='INSTALLDIR' Name='FrEnSampleModel'>
					<Component Id='ModelFile' Guid='A4A8D1D8-892F-4C1A-BA79-57EFA74C037B'>
					  <File Id='MOSESINI' Name='moses.ini' DiskId='1' Source='binarized/moses.ini' KeyPath='yes'/>
					  <File Id='LM' Name='onlymono.en.lm' DiskId='1' Source='binarized/onlymono.en.lm'/>
					  <File Id='PT1' Name='phrase-table.binphr.idx' DiskId='1' Source='binarized/phrase-table.binphr.idx'/>
					  <File Id='PT2' Name='phrase-table.binphr.srctree' DiskId='1' Source='binarized/phrase-table.binphr.srctree'/>
					  <File Id='PT3' Name='phrase-table.binphr.srcvoc' DiskId='1' Source='binarized/phrase-table.binphr.srcvoc'/>
					  <File Id='PT4' Name='phrase-table.binphr.tgtdata' DiskId='1' Source='binarized/phrase-table.binphr.tgtdata'/>
					  <File Id='PT5' Name='phrase-table.binphr.tgtvoc' DiskId='1' Source='binarized/phrase-table.binphr.tgtvoc'/>
					  <File Id='RT1' Name='reordering-table.wbe-msd-bidirectional-fe.binlexr.idx' DiskId='1' Source='binarized/reordering-table.wbe-msd-bidirectional-fe.binlexr.idx'/>
					  <File Id='RT2' Name='reordering-table.wbe-msd-bidirectional-fe.binlexr.srctree' DiskId='1' Source='binarized/reordering-table.wbe-msd-bidirectional-fe.binlexr.srctree'/>
					  <File Id='RT3' Name='reordering-table.wbe-msd-bidirectional-fe.binlexr.tgtdata' DiskId='1' Source='binarized/reordering-table.wbe-msd-bidirectional-fe.binlexr.tgtdata'/>
					  <File Id='RT4' Name='reordering-table.wbe-msd-bidirectional-fe.binlexr.voc0' DiskId='1' Source='binarized/reordering-table.wbe-msd-bidirectional-fe.binlexr.voc0'/>
					  <File Id='RT5' Name='reordering-table.wbe-msd-bidirectional-fe.binlexr.voc1' DiskId='1' Source='binarized/reordering-table.wbe-msd-bidirectional-fe.binlexr.voc1'/>
					</Component>
				</Directory>
			</Directory>
        </Directory>
      </Directory>
	  
	  <Directory Id="ProgramMenuFolder" Name="Programs">
		<Directory Id="MosesDir" Name="Moses">
			<Directory Id="ProgramMenuDir" Name="FrEnSampleModel">
			  <Component Id="ProgramMenuDir" Guid="8E6DCBF8-1409-4942-AD8E-15498C4B1F88">
				<RemoveFolder Id='RemoveMosesDir' Directory="MosesDir" On='uninstall' />
				<RemoveFolder Id='ProgramMenuDir' On='uninstall' />
				<RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Name='Path' Type='string' Value='[INSTALLDIR]' KeyPath='yes'/>
			  </Component>
			</Directory>
        </Directory>
      </Directory>
    </Directory>
	
	<DirectoryRef Id="ProgramMenuDir">
		<Component Id="StartCmdExeShortCut" Guid="8A8E10DF-6E59-474B-8B0B-AF216F23E3B1">
				<Shortcut Id="StartCmdExeMenuShortCut" 
					  Name="Start Command Prompt to Run Model"
					  Directory="ProgramMenuDir"
					  Target="[SystemFolder]cmd.exe"
					  Arguments='/K "[MOSESDECODERPATH]moses-cmd.exe" -f moses.ini'
					  WorkingDirectory='INSTALLDIR'/>
				<RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]\Shortcuts' Name="FrEnCmd" Type='integer' Value='1' KeyPath='yes'/>
			</Component>
			
			<Component Id="Uninstallation" Guid="DDEE6B92-1C61-4ABF-9DB9-561D79EB9500">
					<Shortcut Id="UninstallationShortCut" 
						  Name="Uninstall"
						  Directory="ProgramMenuDir"
						  Target="[SystemFolder]msiexec.exe"
						  Arguments="/x [ProductCode]"
						  WorkingDirectory='INSTALLDIR'/>
					<RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]\Shortcuts' Name="FrEnUninstall" Type='integer' Value='1' KeyPath='yes'/>
			</Component>
	</DirectoryRef>
	
    <Feature Id='Complete' Title='Models' Description='The model package.' Display='expand' Level='1' >
		<Feature Id='ModelFeature' Title='French to English Model' Description='French to English Model' Level='1' ConfigurableDirectory='INSTALLDIR'>
			<ComponentRef Id='ModelFile' />
			<ComponentRef Id='ProgramMenuDir' />
			<ComponentRef Id="StartCmdExeShortCut" />
			<ComponentRef Id="Uninstallation" />
		</Feature>
    </Feature>
	
	<UI Id='Mondo'>
		<UIRef Id="WixUI_Mondo" />
		<UIRef Id="WixUI_ErrorProgressText" />
		<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="SetupTypeDlg" Order="3">1</Publish>
		<Publish Dialog="SetupTypeDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="3">1</Publish>
	</UI>

  </Product>
</Wix>
